var baseUrl="http://localhost:8000/",catalogoUrl="http://localhost:8000/api/catalogo/",client_id="YX73ry9Xck7OvBz15VELaBazyNYAdulgtOhADJJc",client_secret="tcLfskNxdkvO7ENxFGM3JGQ0dmc7vWwatHNe5Tl9fX4CDFRlsmN2vrcphlHSPMuZKydSVB8nupZuEWAUOJmpa4W3s0akd2faiVsnUe4VYbdgdH5MlbJdSQtmQczXO29H",grant_type="password",config={baseUrl:baseUrl,catalogoUrl:catalogoUrl,client_id:client_id,client_secret:client_secret,grant_type:grant_type};app.value("config",config),app.config(function($stateProvider,$urlRouterProvider){$stateProvider.state("catalogo",{url:"/catalogo",views:{"":{templateUrl:"app/views/layout.html"},aside:{templateUrl:"app/views/aside.html"},content:{templateUrl:"app/views/content.html"}}}).state("catalogo.ct",{url:"/ct",data:{section:"Catálogo",page:"Document"},templateUrl:"app/views/pages/document.html"}).state("catalogo.categoria",{url:"/categoria",data:{section:"Catálogo",page:"Categoría"},templateUrl:"build/catalogo/views/categoria/index.html"}).state("catalogo.autor",{url:"/autor",data:{section:"Catálogo",page:"Autor"},templateUrl:"build/catalogo/views/autor/index.html"})}),app.controller("AutorCtrl",function($scope,API,$window,$mdDialog){$scope.lista=[],$scope.autor={},$scope.page=1,$scope.list=function(page){API.Autor.list({query:$scope.query,page:page}).$promise.then(function(r){$scope.lista=r.results,$scope.options=r.options},function(err){console.log("Err "+err)})},$scope.list($scope.page),$scope.listAll=function(page,page_size){API.Autor.list({query:$scope.query,page:page,page_size:page_size}).$promise.then(function(r){$scope.lista=r.results,$scope.options=r.options},function(err){console.log("Err "+err)})},$scope.cancel=function(){$mdDialog.cancel()},$scope["new"]=function(evt){$scope.autor.id=null,$scope.autor={},$mdDialog.show({scope:$scope,targetEvent:evt,templateUrl:"build/catalogo/views/autor/formd.html",parent:angular.element(document.body),clickOutsideToClose:!1,preserveScope:!0}).then(function(){$scope.list($scope.page)},function(){})},$scope.sel=function(d){$scope.autor=API.Autor.get({id:d.id}),$mdDialog.show({scope:$scope,templateUrl:"build/catalogo/views/autor/formd.html",parent:angular.element(document.body),clickOutsideToClose:!1,preserveScope:!0}).then(function(){$scope.list($scope.page),$scope.autor={}},function(){})},$scope.save=function(){$scope.autor.id?API.Autor.update({id:$scope.autor.id},$scope.autor).$promise.then(function(r){console.log("r: "+r),$mdDialog.hide()},function(err){console.log("Err "+err)}):API.Autor.save($scope.autor).$promise.then(function(r){console.log("r: "+r),$mdDialog.hide()},function(err){console.log("Err "+err)})},$scope["delete"]=function(d){$window.confirm("Seguro?")&&API.Autor["delete"]({id:d.id}).$promise.then(function(r){console.log("r: "+r),$scope.list($scope.page)},function(err){console.log("Err "+err)})}}),app.controller("CategoriaCtrl",function($scope,API,$window,$mdDialog){$scope.lista=[],$scope.categoria={},$scope.list=function(){API.Categoria.list({query:$scope.query}).$promise.then(function(r){$scope.lista=r},function(err){console.log("Err "+err)})},$scope.list(),$scope.cancel=function(){$mdDialog.cancel()},$scope["new"]=function(evt){$scope.categoria.id=null,$mdDialog.show({scope:$scope,targetEvent:evt,templateUrl:"build/catalogo/views/categoria/formd.html",parent:angular.element(document.body),clickOutsideToClose:!1,preserveScope:!0}).then(function(){$scope.list()},function(){})},$scope.new2=function(evt){$mdDialog.show({targetEvent:evt,scope:$scope,templateUrl:"build/catalogo/views/categoria/formd2.html",preserveScope:!0,parent:angular.element(document.querySelector("#id")),clickOutsideToClose:!1}).then(function(){$scope.list()},function(){})},$scope.sel=function(d){$scope.categoria=API.Categoria.get({id:d.id}),$mdDialog.show({scope:$scope,templateUrl:"build/catalogo/views/categoria/formd.html",parent:angular.element(document.body),clickOutsideToClose:!1,preserveScope:!0}).then(function(){$scope.list()},function(){})},$scope.save=function(){$scope.categoria.id?API.Categoria.update({id:$scope.categoria.id},$scope.categoria).$promise.then(function(r){console.log("r: "+r),$mdDialog.hide()},function(err){console.log("Err "+err)}):API.Categoria.save($scope.categoria).$promise.then(function(r){console.log("r: "+r),$mdDialog.hide()},function(err){console.log("Err "+err)})},$scope["delete"]=function(d){$window.confirm("Seguro?")&&API.Categoria["delete"]({id:d.id}).$promise.then(function(r){console.log("r: "+r),$scope.list()},function(err){console.log("Err "+err)})}}),app.factory("API",function($resource,config){var url=config.catalogoUrl;return{Categoria:$resource(url+"categorias/:id/",{id:"@id"},{update:{method:"PUT"},list:{method:"GET",isArray:!0,params:{query:"@query"}}}),Autor:$resource(url+"autors/:id/",{id:"@id"},{update:{method:"PUT"},list:{method:"GET",isArray:!1,params:{query:"@query",page:"@page",page_size:"@page_size"}}}),Libro:$resource(url+"libros/:id/",{id:"@id"},{update:{method:"PUT"},list:{method:"GET",isArray:!0}})}});